var opt = {epsilon: 10}; // epsilon is learning rate (10 = default)
var tsne = new tsnejs.tSNE(opt); // create a tSNE instance

// initialize data. Here we have 3 points and some example pairwise dissimilarities

function consolelog() {
    console.log(labels);
    console.log(dataset);
}

/*var dists = [[0.08874040842056274, 0.36570313572883606, 0.13205599784851074, -0.30930909514427185, 0.1608514040708542, -0.5783278942108154, -0.07347344607114792, 0.5682558417320251, 1.4392118453979492, 0.5402835011482239, 0.5797898173332214, -0.15672357380390167, 0.9596752524375916, 0.16058354079723358, -0.2959403693675995, -0.09165521711111069, -0.013288239948451519, 0.1760929822921753, -0.047663938254117966, -0.060186367481946945, -0.16961443424224854, 0.24465857446193695, -0.5192290544509888, -0.04038204625248909, -3.861978530883789, -0.8737807273864746, 0.06028902903199196, 0.16788052022457123, 0.12059100717306137, 0.10071134567260742, -0.5369480848312378, -0.008337766863405704, -0.08766952157020569, 0.12576930224895477, -0.19404582679271698, 0.3900964558124542, -0.4413870871067047, 0.1566796749830246, -0.15927833318710327, -0.4340539872646332, 0.9587891697883606, -0.550012469291687, 0.11277440190315247, 0.02275378443300724, 0.15099112689495087, 0.20380906760692596, -0.9848537445068359, 0.1695324033498764, 0.3665928840637207, 0.10069367289543152, 0.08225961774587631, -0.644676923751831, 0.16973917186260223, -1.3194254636764526, -0.1582566201686859, -0.01615598052740097, 0.2722223401069641, -0.25225964188575745, -0.6241449117660522, 0.21358080208301544, 0.33545640110969543, 0.7419695854187012, -0.30263593792915344, 0.4049576222896576, 0.34656020998954773, -0.17556880414485931, -0.022994518280029297, 0.17647536098957062, 0.16085241734981537, 0.06082553043961525, 0.21795465052127838, -0.035329170525074005, -0.2283344268798828, 0.17485499382019043, 0.19167524576187134, 0.3294092118740082, 0.3596939742565155, 1.5135928392410278, -0.4935019910335541, 0.1195853054523468, -0.446515828371048, -0.09149973839521408, -0.35713693499565125, -0.15255092084407806, -0.32737621665000916, -0.8711283802986145, -0.006376226898282766, -0.1652616411447525, 0.20330345630645752, -1.182479977607727, 0.5231230854988098, -0.45261672139167786, 0.30582913756370544, -0.08283644914627075, -0.16262587904930115, 1.4699815511703491, 0.09202639013528824, 0.15905606746673584, -1.0195773839950562, -0.11351091414690018],
    [0.09526947885751724, 0.3738095462322235, -0.002290927106514573, -0.31552523374557495, 0.0731639415025711, -0.5975690484046936, -0.037988655269145966, 0.5378444790840149, 1.7828599214553833, 0.512380838394165, 0.5366004705429077, -0.17371617257595062, 1.1975231170654297, 0.06214131414890289, -0.2895800471305847, -0.11710904538631439, -0.06669110804796219, 0.18834194540977478, 0.039884865283966064, -0.1060611680150032, -0.11456406116485596, 0.16359804570674896, -0.2121271789073944, -0.04438084363937378, -4.153764724731445, -1.3511643409729004, 0.024434177204966545, 0.13134463131427765, -0.03377853333950043, 0.10360123217105865, -0.3864296078681946, -0.01281115785241127, -0.1529725193977356, 0.0859476625919342, 0.19127370417118073, 0.5399866700172424, -0.3411370515823364, 0.02590532973408699, -0.14293020963668823, -0.17796540260314941, 1.1670267581939697, -0.6891741752624512, -0.007512478623539209, 0.040667712688446045, 0.17701250314712524, 0.2586595416069031, -0.8643807768821716, 0.22762812674045563, 0.32001033425331116, 0.21244962513446808, 0.10404343903064728, -0.5057868361473083, 0.2790616452693939, -1.2577155828475952, -0.3968925178050995, 0.3617599904537201, 0.21042317152023315, -0.3909529447555542, -0.587060272693634, 0.36704614758491516, 0.547111988067627, 0.8134020566940308, -0.3715275824069977, 0.5342313647270203, 0.2164277732372284, -0.11460132896900177, -0.034857865422964096, 0.2844628691673279, 0.13553734123706818, 0.1289701610803604, 0.19606080651283264, 0.06355419754981995, -0.3081414997577667, 0.1700659841299057, 0.02364996075630188, -0.08250435441732407, 0.765418529510498, 1.441970705986023, -0.5533778667449951, 0.26817193627357483, -0.42101266980171204, -0.15297488868236542, -0.30932533740997314, -0.27866530418395996, -0.11152545362710953, -0.9636852145195007, 0.0287263672798872, -0.19227047264575958, -0.503847062587738, -1.273247480392456, 0.39719536900520325, -0.3649551570415497, 0.2354944795370102, -0.0803026556968689, 0.06455263495445251, 1.5223957300186157, 0.2490352839231491, 0.090873584151268, -0.5587570667266846, -0.12229204922914505],
    [0.10100015252828598, 0.14595961570739746, 0.04758552089333534, -0.1849443018436432, -0.02355305477976799, -0.5047867894172668, -0.03987585008144379, 0.38545072078704834, 1.1053080558776855, 0.5082588195800781, 0.1870233714580536, -0.17456673085689545, 0.7447225451469421, -0.018491918221116066, -0.20354284346103668, -0.09216111898422241, -0.12544532120227814, 0.12550275027751923, 0.176024928689003, -0.2698836624622345, 0.020438091829419136, -0.27813485264778137, -0.42403143644332886, 0.04287818819284439, -3.385737180709839, -0.982265293598175, 0.17304740846157074, 0.02847152203321457, -0.23962703347206116, 0.04729434475302696, 0.17725376784801483, -0.010774188674986362, -0.1100103035569191, 0.12391693890094757, 0.3308791220188141, 0.17843154072761536, -0.13446125388145447, 0.03715558350086212, -0.20816434919834137, -0.4031613767147064, 0.7590153217315674, -0.1699531525373459, -0.1496843546628952, 0.03776637464761734, -0.01096623856574297, -0.03688422217965126, -0.8655213117599487, 0.15200351178646088, 0.3417075574398041, 0.24178043007850647, 0.22260376811027527, -0.3607937693595886, 0.23833909630775452, -1.0624042749404907, -0.2572639286518097, 0.07980577647686005, 0.039309024810791016, -0.5308167338371277, -1.1359397172927856, 0.31132572889328003, 0.3046247065067291, 0.45595577359199524, -0.31204062700271606, 0.4222109913825989, 0.1988648623228073, -0.06594102084636688, -0.024747692048549652, 0.726462721824646, 0.03458483889698982, 0.08082716166973114, 0.02086753398180008, 0.02917185053229332, -0.027834640815854073, 0.06763322651386261, 0.02390156500041485, 0.1415504813194275, 0.41793951392173767, 1.5175848007202148, -0.21562378108501434, 0.2811397612094879, -0.3283272981643677, -0.13180990517139435, -0.2874096632003784, -0.39517295360565186, -0.39782652258872986, -0.9107515215873718, -0.09624388813972473, -0.15779423713684082, -0.4619368016719818, -0.6550796031951904, 0.42081689834594727, -0.12271049618721008, -0.008143015205860138, -0.02166714146733284, -0.2621003985404968, 1.3035879135131836, 0.11751196533441544, 0.2696020007133484, -0.6083859205245972, -0.1451989859342575],
    [0.08556945621967316, 0.41252413392066956, -0.15378127992153168, -0.26937100291252136, 0.06874936074018478, -0.8088070750236511, -0.05225037783384323, 0.44006580114364624, 1.1446174383163452, 0.12000031769275665, 0.7909311056137085, -0.051411502063274384, 0.653943657875061, -0.05372900515794754, -0.15208998322486877, -0.1414065808057785, -0.1776716262102127, 0.12103309482336044, 0.34753647446632385, -0.0714244619011879, 0.0026680268347263336, 0.03569997847080231, -0.4410753846168518, 0.0927772969007492, -2.880448818206787, -0.7219504117965698, 0.1942508965730667, 0.10113062709569931, 0.3374643325805664, 0.1280762255191803, 0.006001966539770365, 0.017315931618213654, -0.14195163547992706, 0.15415771305561066, 0.2920595705509186, 0.2737172544002533, 0.2783833146095276, 0.07030259072780609, -0.362107515335083, -0.592115581035614, 0.7815778255462646, -0.05156267434358597, 0.2423134744167328, -0.2144440859556198, -0.03203240782022476, -0.22647590935230255, -1.381575345993042, -0.11347632110118866, 0.6107015609741211, 0.03368411585688591, 0.8113335371017456, -0.6972333788871765, 0.0065071359276771545, -0.427302747964859, -0.09620045125484467, 0.32563498616218567, 0.10438571870326996, -0.19950108230113983, -1.1345783472061157, 0.14612771570682526, 0.5422095060348511, 0.08206793665885925, 0.058162540197372437, 0.8147441744804382, 0.34871169924736023, -0.23219966888427734, -0.07519969344139099, 0.09617996215820312, 0.36400896310806274, -0.06038553640246391, -0.11226218938827515, 0.12342178821563721, -0.19275034964084625, 0.08561058342456818, 0.2636805474758148, -0.30857083201408386, -0.32835322618484497, 1.8467683792114258, -0.059453051537275314, 0.08941197395324707, -0.810809314250946, -0.07367053627967834, 0.29776328802108765, -0.8296643495559692, -0.2870628237724304, -1.8123791217803955, 0.02927618846297264, -0.2193991243839264, -0.16172794997692108, -0.31227296590805054, 0.3368486166000366, -0.18630199134349823, -0.32360875606536865, 0.023765671998262405, -0.2799138128757477, 1.7788608074188232, 0.011661568656563759, 0.32163429260253906, -1.0791889429092407, -0.10247904062271118]];
    */


tsne.initDataDist(dataset);

for(var k = 0; k < 500; k++) {
    tsne.step(); // every time you call this, solution gets better
}

var Y = tsne.getSolution(); // Y is an array of 2-D points that you can plot

var w = 800;
var h = 800;

//create scale
var xScale = d3.scaleLinear()
    .domain([d3.min(Y, function(d) { return d[0]; })-100, d3.max(Y, function(d) { return d[0]; })+100])
    .range([0, w]);

var yScale = d3.scaleLinear()
    .domain([d3.min(Y, function(d) { return d[1]; })-100, d3.max(Y, function(d) { return d[1]; })+100])
    .range([0, h]);

//Create SVG element
var svg = d3.select("body")
    .append("svg")
    .attr("width", w)
    .attr("height", h);

svg.selectAll("circle")
    .data(Y)
    .enter()
    .append("circle")

    .attr("cx", function(d) {
        return xScale(d[0]);
    })
    .attr("cy", function(d) {
        return yScale(d[1]);
    })
    .attr("r", 5);